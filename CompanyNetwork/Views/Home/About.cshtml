@using CompanyNetwork.TreeStructure

@{
    ViewBag.Title = "About";
}
<h2>@ViewBag.Title.</h2>
<h3>@ViewBag.Message</h3>

<script src="http://code.jquery.com/jquery-1.8.3.js"></script>

<table>
    <tr>
        <td>
            <div id="chartContainer1" style="width: 20%; position: absolute;">
                Загрузка ...
            </div>
        </td>
        <td>
            <div id="chartContainer2" style="width: 20%; position: absolute; margin-left: 30%">
                Загрузка ...
            </div>
        </td>
        <td>
            <div id="chartContainer3" style="width: 20%; position: absolute; margin-left: 60%">
                Загрузка ...
            </div>
        </td>
    </tr>
</table>

<script>
    $(document).ready(function() {
        $.ajax({
            url: '@Url.Action("Chart", "Home")',
            type: 'GET',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function(model) {
                Chart(model, "Average age of employees", "chartContainer1");
            }
        });

        $.ajax({
            url: '@Url.Action("ChartLanguage", "Home")',
            type: 'GET',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (model) {
                Chart(model, "Languages of employees", "chartContainer2");
            }
        });

        $.ajax({
            url: '@Url.Action("ChartExperience", "Home")',
            type: 'GET',
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (model) {
                Chart(model, "Experience of employees", "chartContainer3");
            }
        });
    });

    function Chart(model, title, element) {
        var str = [];

        for (var i = 0; i < model.length; ++i)
        {
            str.push({ y: model[i].Value, name: model[i].Description, legendMarkerType: "triangle" });
        }

        var chart = new CanvasJS.Chart(element,
        {
            title: {
                text: title,
                fontFamily: "arial black"
            },
            animationEnabled: true,
            legend: {
                verticalAlign: "bottom",
                horizontalAlign: "center"
            },
            theme: "theme1",
            data: [
                {
                    type: "pie",
                    indexLabelFontFamily: "Garamond",
                    indexLabelFontSize: 14,
                    indexLabelFontWeight: "bold",
                    startAngle: 0,
                    indexLabelFontColor: "MistyRose",
                    indexLabelLineColor: "darkgrey",
                    indexLabelPlacement: "inside",
                    toolTipContent: "{name}: {y}",
                    showInLegend: true,
                    indexLabel: "#percent%",
                    dataPoints: str
                }
            ]
        });
        chart.render();
    }
        </script>
